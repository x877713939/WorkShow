(window.webpackJsonp=window.webpackJsonp||[]).push([["comment"],{"86ee":function(e,t,i){"use strict";var a={name:"MoreMask",props:{maxHeight:{default:288},disabled:{default:!1},forceShow:{type:Boolean,default:!1},text:{type:Object,default:function(){return{content:"",lineHeight:17,paddingTop:100,align:"center"}}}},data:function(){return{realHeight:0,intervalTime:5e3,intervalId:void 0}},computed:{exccedHeight:function(){return this.realHeight>this.maxHeight||this.forceShow},heightStyle:function(){return{maxHeight:!this.exccedHeight||this.disabled||this.forceShow?"none":"".concat(this.maxHeight,"px"),paddingBottom:this.forceShow||this.exccedHeight&&!this.disabled?"25px":"0"}},textStyle:function(){return{paddingTop:"".concat(this.text.paddingTop,"px"),lineHeight:"".concat(this.text.lineHeight,"px"),textAlign:"".concat(this.text.align)}}},mounted:function(){var e=this;this.intervalId=setInterval((function(){e.intervalTime-=500,e.intervalTime<0?clearInterval(e.intervalId):e.realHeight=e.$el.getBoundingClientRect().height}),500)},methods:{maskLoadMore:function(){this.$emit("maskLoadMore")}}},n=i("a6c2"),s=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"more-mask"},[i("div",{staticClass:"more-mask__body",style:e.heightStyle},[e._t("default")],2),e.disabled?e._e():i("div",{directives:[{name:"show",rawName:"v-show",value:e.exccedHeight,expression:"exccedHeight"}],staticClass:"more-mask__footer",style:e.textStyle,on:{touchstart:function(t){return t.preventDefault(),e.maskLoadMore(t)}}},[e._v("\n    "+e._s(e.text.content||"点击查看更多")+"\n  ")])])}),[],!1,null,null,null);t.a=s.exports},d6a4:function(e,t,i){"use strict";i.r(t),i("e7e5");var a=i("d399"),n=i("75fc"),s=i("3ce7"),r={name:"Comment",components:{review:i("e656").a},data:function(){return{reviews:[],loading:!1,finished:!1,offset:0,ApiType:{course:"getCourseReviews",classroom:"getClassroomReviews"}}},computed:{isClass:function(){return"classroom"===this.type}},created:function(){},methods:{onLoad:function(){var e=this,t=this.$route.params.id,i=this.$route.query.type,r=this.ApiType;s.a[r[i]]({query:{id:t},params:{offset:this.offset}}).then((function(t){var i=t.data,a=t.paging,s=e.reviews,r=a.total;e.reviews=[].concat(Object(n.a)(s),Object(n.a)(i)),e.offset=e.reviews.length,e.reviews.length==r&&(e.finished=!0),e.loading=!1})).catch((function(t){a.a.fail(t.message),e.loading=!1}))}}},o=i("a6c2"),c=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"comment"},[i("van-list",{staticStyle:{"margin-top":"0"},attrs:{finished:e.finished},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e._l(e.reviews,(function(t){return[i("review",{attrs:{"is-class":e.isClass,review:t,"disable-mask":!1,course:t.course,"time-format":"complete"}})]}))],2)],1)}),[],!1,null,null,null);t.default=c.exports},e656:function(e,t,i){"use strict";i("c5f6");var a=i("86ee"),n=i("0d25"),s={name:"Review",components:{moreMask:a.a},filters:{userName:function(e){return e&&e.nickname||"匿名用户"},avatar:function(e){return e&&e.avatar&&e.avatar.middle},time:function(e,t){var i=new Date(e);return"simple"===t?Object(n.formatSimpleTime)(i):"complete"===t?Object(n.formatCompleteTime)(i):e}},props:{review:{type:Object,default:function(){return{}}},course:{type:Object,default:function(){return{}}},disableMask:{type:Boolean,default:!0},isClass:{type:Boolean,default:!0},timeFormat:{type:String,default:"simple"}},data:function(){return{loadAllReview:!1}},computed:{posts:function(){return this.review&&this.review.posts||[]},rating:{get:function(){return Number(this.review.rating)},set:function(){}},emptyRating:{get:function(){return this.rating>=0?Number(5-this.rating):5},set:function(){}},textOption:function(){return{paddingTop:70,lineHeight:25,align:"right",content:"显示全部"}},courseTitle:function(){return this.isClass?"":this.course.displayedTitle}}},r=i("a6c2"),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"e-review"},[i("img",{staticClass:"e-review-avatar avatar-img",attrs:{src:e._f("avatar")(e.review.user),alt:""}}),i("div",{staticClass:"e-review-body"},[i("div",[i("span",{staticClass:"e-review-nickname text-14"},[e._v(e._s(e._f("userName")(e.review.user)))]),i("van-rate",{staticClass:"e-review-rating",attrs:{size:15,count:e.emptyRating,readonly:!0,color:"#B0BDC9"},model:{value:e.emptyRating,callback:function(t){e.emptyRating=t},expression:"emptyRating"}}),i("van-rate",{staticClass:"e-review-rating",attrs:{size:15,count:e.rating,readonly:!0,color:"#FFAA00"},model:{value:e.rating,callback:function(t){e.rating=t},expression:"rating"}})],1),i("div",{staticClass:"e-review-time text-12"},[e._v(e._s(e._f("time")(e.review.createdTime,e.timeFormat)))]),e.disableMask?i("div",{staticClass:"e-review-content text-14"},[e._v(e._s(e.review.content))]):i("more-mask",{attrs:{text:e.textOption,"max-height":100,disabled:e.loadAllReview},on:{maskLoadMore:function(t){e.loadAllReview=!0}}},[i("div",{staticClass:"e-review-content text-14"},[e._v(e._s(e.review.content))])]),e.courseTitle?i("span",{staticClass:"e-review-origin text-12"},[e._v("来自："+e._s(e.courseTitle))]):e._e(),e._l(e.posts,(function(t){return i("div",{staticClass:"e-review__post"},[i("img",{staticClass:"e-review-avatar e-review__post-avatar avatar-img",attrs:{src:e._f("avatar")(t.user),alt:""}}),i("div",{staticClass:"e-review__post-body"},[i("span",{staticClass:"e-review-nickname text-14"},[e._v(e._s(e._f("userName")(t.user))+" 回复 "+e._s(e._f("userName")(e.review.user))+"：")]),i("div",{staticClass:"e-review-content text-14"},[e._v(e._s(t.content))])])])}))],2)])}),[],!1,null,null,null);t.a=o.exports}}]);