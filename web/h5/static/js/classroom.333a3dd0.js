(window.webpackJsonp=window.webpackJsonp||[]).push([["classroom"],{4127:function(e,t,r){"use strict";var i=r("d233"),s=r("b313"),a=Object.prototype.hasOwnProperty,n={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,o(t)?t:[t])},u=Date.prototype.toISOString,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,formatter:s.formatters[s.default],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},p=function e(t,r,s,a,n,c,u,p,f,h,m,v,y){var b=t;if("function"==typeof u?b=u(r,b):b instanceof Date?b=h(b):"comma"===s&&o(b)&&(b=b.join(",")),null===b){if(a)return c&&!v?c(r,d.encoder,y):r;b=""}if("string"==typeof b||"number"==typeof b||"boolean"==typeof b||i.isBuffer(b))return c?[m(v?r:c(r,d.encoder,y))+"="+m(c(b,d.encoder,y))]:[m(r)+"="+m(String(b))];var g,O=[];if(void 0===b)return O;if(o(u))g=u;else{var w=Object.keys(b);g=p?w.sort(p):w}for(var _=0;_<g.length;++_){var j=g[_];n&&null===b[j]||(o(b)?l(O,e(b[j],"function"==typeof s?s(r,j):r,s,a,n,c,u,p,f,h,m,v,y)):l(O,e(b[j],r+(f?"."+j:"["+j+"]"),s,a,n,c,u,p,f,h,m,v,y)))}return O};e.exports=function(e,t){var r,i=e,c=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=s.default;if(void 0!==e.format){if(!a.call(s.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=s.formatters[r],n=d.filter;return("function"==typeof e.filter||o(e.filter))&&(n=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:n,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof c.filter?i=(0,c.filter)("",i):o(c.filter)&&(r=c.filter);var u,f=[];if("object"!=typeof i||null===i)return"";u=t&&t.arrayFormat in n?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var h=n[u];r||(r=Object.keys(i)),c.sort&&r.sort(c.sort);for(var m=0;m<r.length;++m){var v=r[m];c.skipNulls&&null===i[v]||l(f,p(i[v],v,h,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.formatter,c.encodeValuesOnly,c.charset))}var y=f.join(c.delimiter),b=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),y.length>0?b+y:""}},4328:function(e,t,r){"use strict";var i=r("4127"),s=r("9e6a"),a=r("b313");e.exports={formats:a,parse:s,stringify:i}},"504c":function(e,t,r){var i=r("9e1e"),s=r("0d58"),a=r("6821"),n=r("52a7").f;e.exports=function(e){return function(t){for(var r,o=a(t),c=s(o),l=c.length,u=0,d=[];l>u;)r=c[u++],i&&!n.call(o,r)||d.push(e?[r,o[r]]:o[r]);return d}}},8615:function(e,t,r){var i=r("5ca1"),s=r("504c")(!1);i(i.S,"Object",{values:function(e){return s(e)}})},8807:function(e,t,r){"use strict";r("a481"),r("ac6a"),r("456d"),r("7f7f"),r("c5f6"),r("8e6e");var i=r("bd86"),s=r("2f62");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={props:{type:{type:String,default:"price"},course:{type:Object,default:{}},order:{type:Object,default:{}}},data:function(){return{isFree:0==this.course.price}},computed:n(n({},Object(s.d)(["courseSettings"])),{},{rate:function(){return parseInt(this.course.publishedTaskNum)?parseInt(this.course.progress.percent):0},showStudent:function(){return!this.courseSettings||Number(this.courseSettings.show_student_num_enabled)}}),filters:{numFilter:function(e){return e?parseFloat(e).toFixed(2):""}},methods:{goToPay:function(){this.$router.push({path:"/pay",query:{id:this.order.id,source:"order",sn:this.order.sn,targetId:this.order.targetId,targetType:this.order.targetType}})}}},c=r("a6c2"),l={components:{switchBox:Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"e-course-switch-box"},["price"===e.type?r("div",{staticClass:"switch-box"},[r("span",{staticClass:"switch-box__price"},[e.isFree?r("p",{staticClass:"free"},[e._v("免费")]):e._e(),e.isFree?e._e():r("p",{staticClass:"price"},[e._v("¥ "+e._s(e.course.price))])]),r("span",{staticClass:"switch-box__state"},[e.showStudent?r("p",[e._v(e._s(e.course.studentNum)+"人在学")]):e._e()])]):e._e(),"order"===e.type?r("div",{staticClass:"switch-box"},[r("span",{staticClass:"switch-box__price"},[e.isFree?r("p",{staticClass:"free"},[e._v("免费")]):e._e(),e.isFree?e._e():r("p",{staticClass:"price"},[e._v("¥ "+e._s(e.order.pay_amount/100))])]),r("span",{staticClass:"switch-box__state"},["created"!==e.order.status&&"paying"!==e.order.status?r("p",{class:e.order.status},[e._v("\n        "+e._s(e._f("filterOrderStatus")(e.order.status))+"\n      ")]):e._e(),"created"===e.order.status||"paying"===e.order.status?r("span",{staticClass:"order-pay",on:{click:e.goToPay}},[e._v(e._s(e._f("filterOrderStatus")(e.order.status)))]):e._e()])]):e._e(),"confirmOrder"===e.type?r("div",{staticClass:"switch-box"},[r("span",{staticClass:"switch-box__price"},[r("p",{staticClass:"price"},[e._v("¥ "+e._s(e._f("numFilter")(e.order.totalPrice)))])])]):e._e(),"rank"===e.type?r("div",{staticClass:"rank-box"},[r("div",{staticClass:"progress round-conner"},[r("div",{staticClass:"curRate round-conner",style:{width:e.rate+"%"}})]),r("span",[e._v(e._s(this.rate)+"%")])]):e._e()])}),[],!1,null,null,null).exports},props:{course:{type:Object,default:function(){return{}}},order:{type:Object,default:function(){return{}}},type:{type:String,default:"price"},feedback:{type:Boolean,default:!0},typeList:{type:String,default:"course_list"},duration:{type:Number,default:0}},data:function(){return{pathName:this.$route.name}},computed:{imgSrc:function(){if("classroom_list"===this.typeList)return this.course.cover.middle;var e=this.course.courseSet,t=e?e.cover.middle:this.order.cover.middle;return t||""},title:function(){return"classroom_list"===this.typeList?this.course.title:this.course.courseSetTitle||(this.course.courseSet?this.course.courseSet.title:"")||this.order.title},teachPlan:function(){return!!this.course.title&&this.course.title},imgClass:function(){return"vip"===this.typeList?"e-vip__img":"e-course__img"},vipDuration:function(){return"month"===this.order.unitType?"".concat(this.duration,"个月"):"year"===this.order.unitType?"".concat(this.duration,"年"):"".concat(this.duration,"天")}},watch:{course:{handler:function(e){var t=e.courseSet;if("miniprogramSetting"===this.pathName&&t)for(var r=Object.keys(t.cover),i=0;i<r.length;i++)t.cover[r[i]]=t.cover[r[i]].replace(/^(\/\/)|(http:\/\/)/,"https://")},immediate:!0}},methods:{onClick:function(e){if(this.feedback&&"vip"!==this.typeList){var t="order"===this.type,r=this.course.id||this.order.targetId;"SPAN"!==e.target.tagName&&(t?location.href=this.order.targetUrl:"course"!==this.typeList&&("classroom_list"===this.typeList&&this.$router.push({path:"/classroom/".concat(r)}),"course_list"===this.typeList&&this.$router.push({path:"/course/".concat(r)})))}}}},u=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"e-course"},[r("div",{staticClass:"clearfix",on:{click:e.onClick}},[r("div",{staticClass:"e-course__left pull-left"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgSrc,expression:"imgSrc"}],class:e.imgClass})]),r("div",{staticClass:"e-course__right pull-left"},["confirmOrder"===e.type?r("div",{staticClass:"e-course__title course-confirm-title"},[e._v("\n        "+e._s(e.title)),"vip"===e.typeList?r("span",{staticClass:"grey-medium"},[e._v(" x "+e._s(e.vipDuration))]):e._e()]):r("div",[r("div",{staticClass:"e-course__title text-overflow"},[e._v(e._s(e.title))]),"classroom_list"===e.typeList?r("div",{staticClass:"e-course__count"},[e._v("\n          共 "+e._s(e.course.courseNum)+" 门课程\n        ")]):e._e(),"course_list"===e.typeList?r("div",{staticClass:"e-course__project text-overflow"},[e.teachPlan?r("span",[e._v(e._s(e.teachPlan))]):e._e()]):e._e()]),r("switchBox",{attrs:{type:e.type,course:e.course,order:e.order,"student-num":e.course.studentNum,"published-task-num":e.course.publishedTaskNum}})],1)])])}),[],!1,null,null,null);t.a=u.exports},"8ab6":function(e,t,r){"use strict";r.r(t),r("8e6e"),r("ac6a"),r("456d"),r("e7e5");var i=r("d399"),s=r("bd86"),a=(r("e17f"),r("2241")),n={name:"Teacher",props:["teacherInfo","title","defaulValue"]},o=r("a6c2"),c=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("e-panel",{attrs:{title:e.title,"defaul-value":e.defaulValue}},[e._l(e.teacherInfo,(function(t){return e.teacherInfo.length?[r("div",{staticClass:"teacher-content"},[r("img",{staticClass:"avatar-img",attrs:{src:t.avatar&&t.avatar.large}}),r("div",{staticClass:"teacher-cell"},[r("span",{staticClass:"dark font-family-PFM"},[e._v(e._s(t.nickname))]),r("span",{directives:[{name:"show",rawName:"v-show",value:t.title,expression:"item.title"}],staticClass:"text-content"},[e._v(e._s(t.title))])])])]:e._e()}))],2)}),[],!1,null,null,null).exports,l=r("fd23"),u=r("bced"),d=r("3ce7"),p=r("4328"),f=r.n(p),h=r("2f62");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}var v={components:{countDown:l.a,tagLink:u.a},props:{cover:{type:String,default:""},price:{type:String,default:""},classroomId:{type:String,default:0},seckillActivities:{type:Object,default:null}},data:function(){return{counting:!0,isEmpty:!1,tagData:{earnings:0,isShow:!1,link:"",className:"course-tag",minDirectRewardRatio:0},bindAgencyRelation:{}}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(h.d)(["DrpSwitch"])),created:function(){this.showTagLink()},methods:{expire:function(){this.counting=!1},sellOut:function(){this.isEmpty=!0,this.$emit("goodsEmpty")},showTagLink:function(){this.DrpSwitch?(this.initTagData(),this.getAgencyBindRelation()):this.tagData.isShow=!1},getAgencyBindRelation:function(){var e=this;d.a.getAgencyBindRelation().then((function(t){t.agencyId?(e.bindAgencyRelation=t,e.tagData.isShow=!0):e.tagData.isShow=!1}))},initTagData:function(){var e=this;d.a.getDrpSetting().then((function(t){e.drpSetting=t,e.tagData.minDirectRewardRatio=t.minDirectRewardRatio;var r={type:"classroom",id:e.classroomId,merchant_id:e.drpSetting.merchantId};e.tagData.link=e.drpSetting.distributor_template_url+"?"+f.a.stringify(r);var i=e.drpSetting.minDirectRewardRatio/100*e.price;e.tagData.earnings=(Math.floor(100*i)/100).toFixed(2)}))}}},y=Object(o.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"course-detail__head pos-rl"},[r("div",{staticClass:"course-detail__head--img"},[r("img",{attrs:{src:e.cover,alt:""}})]),e.seckillActivities&&e.counting&&!e.isEmpty&&"ongoing"===e.seckillActivities.status?r("countDown",{attrs:{activity:e.seckillActivities},on:{timesUp:e.expire,sellOut:e.sellOut}}):e._e(),r("tagLink",{attrs:{"tag-data":e.tagData}})],1)}),[],!1,null,null,null).exports,b=r("d0b2"),g=r("8807"),O=r("86ee"),w={name:"CourseSetList",components:{course:g.a,moreMask:O.a},props:{courseSets:{default:null},title:{default:""},defaulValue:{default:""},disableMask:{type:Boolean,default:!1},feedback:{type:Boolean,default:!0}},data:function(){return{maxShowNum:5}},computed:{partCourseSets:function(){return this.courseSets.slice(0,5)}},methods:{loadMore:function(){this.$emit("update:disableMask",!0)}}},_=Object(o.a)(w,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("e-panel",{attrs:{title:e.title,"need-flex":!1,"defaul-value":e.defaulValue}},[e.courseSets.length?[!e.disableMask&&e.courseSets.length>5?r("moreMask",{attrs:{"force-show":!0},on:{maskLoadMore:e.loadMore}},[e._l(e.partCourseSets,(function(t){return[r("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{feedback:e.feedback,course:t}})]}))],2):[e._l(e.courseSets,(function(t){return[r("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{feedback:e.feedback,course:t}})]}))]]:e._e()],2)}),[],!1,null,null,null).exports,j=(r("c5f6"),r("410d")),C=r("0d25");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x={components:{service:j.a},filters:{filterPrice:function(e){return 0===Number(e)?"免费":"¥".concat(e)}},props:{details:{default:{}},joinStatus:{default:!1}},watch:{learnExpiryHtml:{immediate:!0,handler:function(e){this.$emit("getLearnExpiry",{val:e})}}},computed:S(S({},Object(h.d)(["vipSwitch"])),{},{learnExpiryHtml:function(){var e=this.joinStatus,t=this.details.expiryValue,r=this.details.expiryMode;if(e)return"forever"==r?"永久有效":0!=e.deadline?e.deadline.slice(0,10)+"之前可学习":"永久有效";switch(r){case"forever":return"永久有效";case"date":var i=new Date(1e3*t);return Object(C.formatFullTime)(i).slice(0,10)+"之前可学习";case"days":return t+"天内可学习"}}})},D=Object(o.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"classroom-plan"},[r("e-panel",{attrs:{title:e.details.title}},[r("div",{staticClass:"course-detail__plan-price"},[r("span",{class:{isFree:0===Number(e.details.price)}},[e._v(e._s(e._f("filterPrice")(e.details.price)))]),r("span",{staticClass:"plan-price__student-num"},[e._v(e._s(e.details.studentNum)+"人在学")])])]),r("div",{staticClass:"course-detail__validity"},[e.details.vipLevel&&e.vipSwitch?r("div",{staticClass:"mb15"},[r("span",{staticClass:"mr20"},[e._v("会员免费")]),r("img",{staticClass:"vipIcon",attrs:{src:e.details.vipLevel.icon}}),r("router-link",{staticClass:"color-primary",attrs:{to:{path:"/vip",query:{id:e.details.vipLevel.id}}}},[e._v(e._s(e.details.vipLevel.name)+"免费学")])],1):e._e(),e.details.service.length?r("service",{attrs:{services:e.details.service}}):e._e(),r("div",[r("span",[e._v("学习有效期：")]),r("span",{domProps:{innerHTML:e._s(e.learnExpiryHtml)}})])],1)],1)}),[],!1,null,null,null).exports,P=r("b127"),E={components:{directory:P.a,detailHead:y,detailPlan:D,teacher:c,courseSetList:_,reviewList:b.a,moreMask:O.a},props:["details","planDetails"],data:function(){return{headBottom:0,active:1,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:"",errorMsg:""}},mounted:function(){window.addEventListener("touchmove",this.handleScroll),this.showDialog()},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll)},methods:{showDialog:function(){var e=this,t="",r="",s=function(){};if(this.details.member&&(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t))if(this.errorMsg=this.getErrorMsg(t),"classroom.expired"===t||"member.expired"===t){r="班级已到期，无法继续学习，是否退出";var a={id:this.details.classId};s=function(){d.a.deleteClassroom({query:a}).then((function(e){e.success?window.location.reload():i.a.fail("退出班级失败，请稍后重试")}))},this.callConfirm(r,s)}else"vip.member_expired"===t?(r="会员已到期，请及时续费会员",s=function(){e.$router.push({path:"/vip"})},this.callConfirm(r,s)):i.a.fail(this.getErrorMsg(t))},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs;setTimeout((function(){e.headBottom=t.head.$el.getBoundingClientRect().bottom,e.scrollFlag=!1,e.tabsClass=e.headBottom<=0?"van-tabs--fixed":""}),400)}},getErrorMsg:function(e){switch(e){case"classroom.not_found":return"当前班级不存在";case"classroom.unpublished":return"当前班级未发布";case"classroom.expired":return"当前班级已过期";case"user.not_login":return"用户未登录";case"user.locked":return"用户被锁定";case"member.not_found":return"用户未加入班级";case"member.auditor":return"用户是旁听生";case"member.expired":return"班级已过期";case"vip.vip_closed":return"网校已关闭会员功能";case"vip.not_login":return"用户未登录";case"vip.not_member":return"当前用户并不是vip";case"vip.member_expired":return"用户会员服务已过期";case"vip.level_not_exist":return"用户会员等级或班级会员不存在";case"vip.level_low":return"用户会员等级过低";default:return"异常错误"}},callConfirm:function(e,t){a.a.confirm({message:e,title:""}).then((function(){t()})).catch((function(){}))}}},T=Object(o.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"course-detail classroom-detail"},[r("div",{staticClass:"join-after"},[r("detail-head",{ref:"head",attrs:{cover:e.details.cover,price:e.planDetails.price,"classroom-id":e.details.classId}}),r("van-tabs",{class:e.tabsClass,model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return r("van-tab",{key:e,attrs:{title:e}})})),1),0==e.active?r("div",{staticStyle:{"margin-top":"44px"}},[r("detail-plan",{attrs:{details:e.planDetails,"join-status":e.details.joinStatus}}),r("div",{staticClass:"segmentation"}),r("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[r("div",{domProps:{innerHTML:e._s(e.details.summary)}})]),r("div",{staticClass:"segmentation"}),r("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers,title:"教师介绍"}}),r("div",{staticClass:"segmentation"}),r("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.headTeacher?[e.details.headTeacher]:[],title:"班主任","defaul-value":"尚未设置班主任"}})],1):e._e(),1==e.active?r("div",{staticStyle:{"margin-top":"44px"}},[r("course-set-list",{ref:"course",attrs:{feedback:!e.errorMsg,"course-sets":e.details.courses,"disable-mask":!0,title:"班级课程","defaul-value":"暂无课程"},nativeOn:{click:function(t){return e.showDialog(t)}}})],1):e._e(),2==e.active?r("div",{staticStyle:{"margin-top":"44px"}},[r("review-list",{ref:"review",attrs:{"target-id":e.details.classId,reviews:e.details.reviews,title:"学员评价","defaul-value":"暂无评价",type:"classroom"}})],1):e._e()],1)])}),[],!1,null,null,null).exports,L=r("49a2"),N=r("d863"),A=r("8b9d"),M=r("a262");function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R={components:{directory:P.a,detailHead:y,detailPlan:D,teacher:c,courseSetList:_,reviewList:b.a,moreMask:O.a,onsale:L.a},mixins:[N.a,A.a,M.a],props:["details","planDetails"],data:function(){return{tops:{aboutTop:0,courseTop:0,reviewTop:0},active:0,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:"",loadMoreAbout:!1,disableMask:!1,learnExpiry:"永久有效",unreceivedCoupons:[],miniCoupons:[],marketingActivities:{seckill:{}},isEmpty:!0,scrollTime:null,isManualSwitch:!1}},computed:F(F({},Object(h.d)(["couponSwitch","user"])),{},{accessToJoin:function(){return"success"===this.details.access.code||"user.not_login"===this.details.access.code},vipAccessToJoin:function(){var e=!1;return!(!this.details.vipLevel||!this.user.vip)&&(this.details.vipLevel.seq<=this.user.vip.seq&&(e=!(new Date(this.user.vip.deadline).getTime()<(new Date).getTime())),e)},showOnsale:function(){return 0!==Number(this.planDetails.price)&&!!(this.unreceivedCoupons.length||Object.keys(this.marketingActivities).length&&!this.onlySeckill)},onlySeckill:function(){return 1===Object.keys(this.marketingActivities).length&&this.marketingActivities.seckill},seckillStatus:function(){var e=this.marketingActivities.seckill;return Object(C.dateTimeDown)(new Date(e.endTime).getTime())},showSeckill:function(){var e=this.marketingActivities.seckill;return 0!==Number(this.planDetails.price)&&e&&"ongoing"===e.status&&!this.isEmpty}}),mounted:function(){var e=this;this.couponSwitch&&d.a.searchCoupon({params:{targetId:this.details.classId,targetType:"classroom"}}).then((function(t){e.unreceivedCoupons=t.data,e.miniCoupons=e.unreceivedCoupons.length>3?e.unreceivedCoupons.slice(0,4):e.unreceivedCoupons})).catch((function(e){})),d.a.classroomsActivities({query:{id:this.details.classId}}).then((function(t){e.marketingActivities=t,e.isEmpty=!t.seckill||!+t.seckill.productRemaind})).catch((function(e){})),window.addEventListener("touchmove",this.handleScroll),window.addEventListener("scroll",this.handleScroll),setTimeout((function(){window.scrollTo(0,0)}),100)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll),window.removeEventListener("scroll",this.handleScroll)},methods:{onTabClick:function(e,t){var r=this;this.isManualSwitch=!0;var i=this.$refs[this.transIndex2Tab(e)];window.scrollTo(0,i.$el.offsetTop-44),setTimeout((function(){return r.isManualSwitch=!1}),500)},transIndex2Tab:function(e){return["about","course","review"][e]},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs,r=["about","course","review"].reverse();this.scrollTime&&clearTimeout(this.scrollTime),this.scrollTime=setTimeout((function(){Object.keys(t).forEach((function(r){e.tops["".concat(r,"Top")]=t[r].$el.getBoundingClientRect().top})),e.scrollFlag=!1,e.tabsClass=e.tops.aboutTop-44<=0?"van-tabs--fixed":"",e.setCurrentActive(r)}),400)}},setCurrentActive:function(e){if(!this.isManualSwitch){for(var t=0;t<e.length;t++)if(!(this.tops["".concat(e[t],"Top")]-44>0))return void(this.active=e.length-t-1);this.active=0}},handleJoin:function(){var e=this,t=this.vipAccessToJoin;if(this.accessToJoin||t){var r=this.details,i=this.planDetails,s=1===Number(r.buyable)||0==+i.price||t;this.$store.state.token?s&&(!+i.price||t?d.a.joinClass({query:{classroomId:r.classId}}).then((function(t){e.details.joinStatus=t})).catch((function(e){})):this.$router.push({name:"order",params:{id:r.classId},query:{expiryScope:this.learnExpiry,targetType:"classroom"}})):this.$router.push({name:"login",query:{redirect:this.redirect}})}},getLearnExpiry:function(e){var t=e.val;this.learnExpiry=t},sellOut:function(){this.isEmpty=!0}}},$=Object(o.a)(R,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"course-detail classroom-detail"},[r("div",{staticClass:"join-before"},[r("detail-head",{attrs:{cover:e.details.cover,price:e.planDetails.price,"classroom-id":e.details.classId,"seckill-activities":e.marketingActivities.seckill},on:{goodsEmpty:e.sellOut}}),r("detail-plan",{attrs:{details:e.planDetails,"join-status":e.details.joinStatus},on:{getLearnExpiry:e.getLearnExpiry}}),r("div",{staticClass:"segmentation"}),e.showOnsale?[r("onsale",{attrs:{"unreceived-coupons":e.unreceivedCoupons,"mini-coupons":e.miniCoupons,activities:e.marketingActivities}}),r("div",{staticClass:"segmentation"})]:e._e(),r("van-tabs",{class:e.tabsClass,on:{click:e.onTabClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return r("van-tab",{key:e,attrs:{title:e}})})),1),r("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[r("more-mask",{attrs:{disabled:e.loadMoreAbout},on:{maskLoadMore:function(t){e.loadMoreAbout=!0}}},[r("div",{domProps:{innerHTML:e._s(e.details.summary)}})])],1),r("div",{staticClass:"segmentation"}),r("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers,title:"教师介绍"}}),r("div",{staticClass:"segmentation"}),r("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.headTeacher?[e.details.headTeacher]:[],title:"班主任","defaul-value":"尚未设置班主任"}}),r("div",{staticClass:"segmentation"}),r("course-set-list",{ref:"course",attrs:{"course-sets":e.details.courses,"disable-mask":e.disableMask,title:"班级课程","defaul-value":"暂无课程"},on:{"update:disableMask":function(t){e.disableMask=t},"update:disable-mask":function(t){e.disableMask=t}}}),r("div",{staticClass:"segmentation"}),r("review-list",{ref:"review",attrs:{"target-id":e.details.classId,reviews:e.details.reviews,title:"学员评价",type:"classroom","defaul-value":"暂无评价"}}),!e.marketingActivities.seckill||e.marketingActivities.seckill&&(e.isEmpty||"已到期"===e.seckillStatus)||0==e.planDetails.price?r("e-footer",{attrs:{disabled:!e.accessToJoin},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v("\n      "+e._s(e._f("filterJoinStatus")(e.details.access.code,"classroom",e.vipAccessToJoin)))]):e._e(),e.showSeckill&&"已到期"!==e.seckillStatus?r("div",[r("e-footer",{attrs:{disabled:!e.accessToJoin,half:"true"},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v(e._s(e._f("filterJoinStatus")(e.details.access.code,"classroom",e.vipAccessToJoin)))]),r("e-footer",{attrs:{half:"true"},nativeOn:{click:function(t){return e.activityHandle(e.marketingActivities.seckill.id)}}},[e._v("去秒杀")])],1):e._e()],2)])}),[],!1,null,null,null).exports;function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}var B={components:{},data:function(){return{details:{isEmpty:!0,summary:"",joinStatus:!1,courses:[],teachers:[],assistants:[],headTeacher:{},access:{code:"加载中"},cover:"",reviews:[],classId:0,vipLevel:null},planDetails:{title:"",service:[],price:"0",studentNum:0,expiryMode:"forever",expiryValue:"0",vipLevel:null},currentComp:""}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(h.d)({isLoading:function(e){return e.isLoading}})),watch:{"details.joinStatus":{handler:function(e){this.getComponent(e)}}},created:function(){var e=this,t=this.$route.params.id;d.a.getClassroomDetail({query:{classroomId:t}}).then((function(t){e.getComponent(t.member),e.getDetails(t)})).catch((function(e){i.a.fail(e.message)}))},methods:{getDetails:function(e){var t=0===Object.keys(e).length,r=e.about,i=!t&&e.member,s=e.courses,a=e.teachers,n=e.assistants,o=e.buyable,c=e.vipLevel,l=e.headTeacher,u=e.access,d=e.reviews,p=e.expiryMode,f=e.member,h=e.expiryValue,m=e.title,v=e.price,y=e.studentNum,b=e.service,g=e.cover.large,O=e.id,w={title:m,service:b,price:v,studentNum:y,expiryMode:p,expiryValue:h,vipLevel:c};this.planDetails=w,this.details={summary:r,joinStatus:i,isEmpty:t,courses:s,classId:O,buyable:o,vipLevel:c,teachers:a,assistants:n,headTeacher:l,access:u,cover:g,reviews:d,member:f}},getComponent:function(e){this.currentComp=e?T:$}}},J=Object(o.a)(B,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail"},[this.isLoading?t("e-loading"):this._e(),t(this.currentComp,{tag:"component",attrs:{details:this.details,"plan-details":this.planDetails}})],1)}),[],!1,null,null,null);t.default=J.exports},"9e6a":function(e,t,r){"use strict";var i=r("d233"),s=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},n=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},o=function(e,t,r){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,n=/(\[[^[\]]*])/.exec(i),o=n?i.slice(0,n.index):i,c=[];if(o){if(!r.plainObjects&&s.call(Object.prototype,o)&&!r.allowPrototypes)return;c.push(o)}for(var l=0;null!==(n=a.exec(i))&&l<r.depth;){if(l+=1,!r.plainObjects&&s.call(Object.prototype,n[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(n[1])}return n&&c.push("["+i.slice(n.index)+"]"),function(e,t,r){for(var i=t,s=e.length-1;s>=0;--s){var a,n=e[s];if("[]"===n&&r.parseArrays)a=[].concat(i);else{a=r.plainObjects?Object.create(null):{};var o="["===n.charAt(0)&&"]"===n.charAt(n.length-1)?n.slice(1,-1):n,c=parseInt(o,10);r.parseArrays||""!==o?!isNaN(c)&&n!==o&&String(c)===o&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(a=[])[c]=i:a[o]=i:a={0:i}}i=a}return i}(c,t,r)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||i.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth?e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null===e||void 0===e)return r.plainObjects?Object.create(null):{};for(var c="string"==typeof e?function(e,t){var r,o={},c=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,u=c.split(t.delimiter,l),d=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<u.length;++r)0===u[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[r]?p="utf-8":"utf8=%26%2310003%3B"===u[r]&&(p="iso-8859-1"),d=r,r=u.length);for(r=0;r<u.length;++r)if(r!==d){var f,h,m=u[r],v=m.indexOf("]="),y=-1===v?m.indexOf("="):v+1;-1===y?(f=t.decoder(m,a.decoder,p),h=t.strictNullHandling?null:""):(f=t.decoder(m.slice(0,y),a.decoder,p),h=t.decoder(m.slice(y+1),a.decoder,p)),h&&t.interpretNumericEntities&&"iso-8859-1"===p&&(h=n(h)),h&&t.comma&&h.indexOf(",")>-1&&(h=h.split(",")),s.call(o,f)?o[f]=i.combine(o[f],h):o[f]=h}return o}(e,r):e,l=r.plainObjects?Object.create(null):{},u=Object.keys(c),d=0;d<u.length;++d){var p=u[d],f=o(p,c[p],r);l=i.merge(l,f,r)}return i.compact(l)}},b313:function(e,t,r){"use strict";var i=String.prototype.replace,s=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return i.call(e,s,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},d233:function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,s=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),n=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r};e.exports={arrayToObject:n,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var a=t[i],n=a.obj[a.prop],o=Object.keys(n),c=0;c<o.length;++c){var l=o[c],u=n[l];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:n,prop:l}),r.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(s(r)){for(var i=[],a=0;a<r.length;++a)void 0!==r[a]&&i.push(r[a]);t.obj[t.prop]=i}}}(t),e},decode:function(e,t,r){var i=e.replace(/\+/g," ");if("iso-8859-1"===r)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(e){return i}},encode:function(e,t,r){if(0===e.length)return e;var i="string"==typeof e?e:String(e);if("iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var s="",n=0;n<i.length;++n){var o=i.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?s+=i.charAt(n):o<128?s+=a[o]:o<2048?s+=a[192|o>>6]+a[128|63&o]:o<55296||o>=57344?s+=a[224|o>>12]+a[128|o>>6&63]+a[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&i.charCodeAt(n)),s+=a[240|o>>18]+a[128|o>>12&63]+a[128|o>>6&63]+a[128|63&o])}return s},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,a){if(!r)return t;if("object"!=typeof r){if(s(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(a&&(a.plainObjects||a.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return s(t)&&!s(r)&&(o=n(t,a)),s(t)&&s(r)?(r.forEach((function(r,s){if(i.call(t,s)){var n=t[s];n&&"object"==typeof n&&r&&"object"==typeof r?t[s]=e(n,r,a):t.push(r)}else t[s]=r})),t):Object.keys(r).reduce((function(t,s){var n=r[s];return i.call(t,s)?t[s]=e(t[s],n,a):t[s]=n,t}),o)}}}}]);