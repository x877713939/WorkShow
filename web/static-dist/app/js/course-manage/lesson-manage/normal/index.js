!function(l){function t(t){for(var s,e,n=t[0],a=t[1],o=t[2],i=0,r=[];i<n.length;i++)e=n[i],Object.prototype.hasOwnProperty.call(u,e)&&u[e]&&r.push(u[e][0]),u[e]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(l[s]=a[s]);for(h&&h(t);r.length;)r.shift()();return d.push.apply(d,o||[]),c()}function c(){for(var t,s=0;s<d.length;s++){for(var e=d[s],n=!0,a=1;a<e.length;a++){var o=e[a];0!==u[o]&&(n=!1)}n&&(d.splice(s--,1),t=i(i.s=e[0]))}return t}var e={},u={124:0},d=[];function i(t){if(e[t])return e[t].exports;var s=e[t]={i:t,l:!1,exports:{}};return l[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=l,i.c=e,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(s,t){if(1&t&&(s=i(s)),8&t)return s;if(4&t&&"object"==typeof s&&s&&s.__esModule)return s;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:s}),2&t&&"string"!=typeof s)for(var n in s)i.d(e,n,function(t){return s[t]}.bind(null,n));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="/static-dist/";var s=window.webpackJsonp=window.webpackJsonp||[],n=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var h=n;d.push([784,0]),c()}({133:function(t,s,e){"use strict";e.d(s,"a",function(){return n});var n=function(t,n){$("body").on("click",t,function(t){function s(){cd.confirm({title:Translator.trans(n.title),content:Translator.trans(n.hint),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){$.post(e.data("url"),function(t){t.success?(cd.message({type:"success",message:Translator.trans(n.success),delay:"1000"}),location.reload()):cd.message({type:"danger",message:Translator.trans(n.fail)+":"+t.message,delay:"5000"})})})}var e=$(t.target);e.data("preUrl")?$.post(e.data("preUrl"),function(t){t.success?(t=cd.loading({isFixed:!0}),$("#modal").html(t).modal({backdrop:"static",keyboard:!1}).load(e.data("saveUrl"))):s()}):s()})}},153:function(t,s,e){"use strict";e.d(s,"b",function(){return a}),e.d(s,"c",function(){return i}),e.d(s,"d",function(){return r}),e.d(s,"a",function(){return l});var n=e(133),a=function(){$("body").on("click",".js-close-course",function(t){var s=$(t.currentTarget);cd.confirm({title:Translator.trans("site.close"),content:Translator.trans("course.manage.close_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){$.post(s.data("checkUrl"),function(t){t.warn?cd.confirm({title:Translator.trans("site.close"),content:Translator.trans(t.message),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){o(s)}):o(s)})})})},o=function(t){$.post(t.data("url"),function(t){t.success?(cd.message({type:"success",message:Translator.trans("course.manage.close_success_hint")}),location.reload()):cd.message({type:"danger",message:Translator.trans("course.manage.close_fail_hint")+":"+t.message})})},i=function(){$("body").on("click",".js-delete-course",function(t){cd.confirm({title:Translator.trans("site.delete"),content:Translator.trans("course.manage.delete_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){$.post($(t.currentTarget).data("url"),function(t){t.success?(cd.message({type:"success",message:Translator.trans("site.delete_success_hint")}),t.redirect?window.location.href=t.redirect:location.reload()):cd.message({type:"danger",message:Translator.trans("site.delete_fail_hint")+":"+t.message})})})})},r=function(){Object(n.a)(".js-publish-course",{title:"course.manage.publish_title",hint:"course.manage.publish_hint",success:"course.manage.publish_success_hint",fail:"course.manage.publish_fail_hint"})},l=function(){var s,e=$(".js-task-list-header");e.length&&(s=e.offset().top,$(window).scroll(function(t){$(window).scrollTop()>=s?e.addClass("fixed"):e.removeClass("fixed")}))}},17:function(t,s){t.exports=jQuery},279:function(t,s,e){"use strict";e.d(s,"b",function(){return n}),e.d(s,"a",function(){return a});var n=function(){cd.onoff({el:".js-switch"}).on("change",function(t){var e=$(".js-switch"),s=e.data("url"),n=e.parent().hasClass("checked")?1:0,a=e.parent().hasClass("checked")?"on":"off";cd.confirm({title:Translator.trans("confirm.oper.tip"),content:Translator.trans("confirm.lesson.hidden.tip."+a),okText:Translator.trans("site.yes"),cancelText:Translator.trans("site.no")}).on("ok",function(){$.post(s,{status:n}).success(function(t){cd.message({type:"success",message:Translator.trans("site.save_success_hint")}),location.reload()}).error(function(t){cd.message({type:"danger",message:t.responseJSON.error.message})})}).on("cancel",function(t,s){e[0].checked=!e[0].checked,e.parent().toggleClass("checked")})})},a=function(){$("body").on("click",".js-lesson-create-btn",function(t){t=$(t.currentTarget).data("url");$.get(t,{}).success(function(t){$("#modal").html(""),$("#modal").append(t.html),$("#modal").modal({backdrop:"static",show:!0})}).error(function(t){cd.message({type:"danger",message:Translator.trans(t.responseJSON.error.message)})})})}},315:function(t,s,e){"use strict";e.d(s,"a",function(){return r});var s=e(0),n=e.n(s),s=e(1),a=e.n(s),i=e(44),o=e(4),r=function(){function s(t){n()(this,s),this.$element=$(t),this._sort(),this._event()}return a()(s,[{key:"_event",value:function(){var e=this;this.$element.on("addItem",function(t,s){e.addItem(s),e.sortList()}),$("body").on("click","[data-position]",function(t){var s=$(this);e.position=s.data("position"),e.type=s.data("type")}),this._deleteChapter(),this._collapse(),this._publish(),this._createTask(),this._optional(),this._initLessonTaskAction()}},{key:"_collapse",value:function(){var n=['<i class="es-icon es-icon-chevronright cd-mr16"></i>','<i class="es-icon es-icon-keyboardarrowdown cd-mr16"></i>'];this.$element.on("click",".js-toggle-show",function(t){var s=$(t.currentTarget);s.toggleClass("toogle-hide");var e=s.closest(".task-manage-item"),t=e.hasClass("js-task-manage-chapter")?".js-task-manage-chapter":".js-task-manage-chapter,.js-task-manage-unit",t=e.nextUntil(t);s.hasClass("js-toggle-unit")?t.toggleClass("unit-hide"):t=t.not(".unit-hide"),t.stop().animate({height:"toggle",opacity:"toggle"},"fast"),s.hasClass("toogle-hide")?s.html(n[0]):s.html(n[1])})}},{key:"addItem",value:function(t){var s=$(t),t=$("#"+s.attr("id"));if(0<t.length)return t.replaceWith(s),void this.afterAddItem(s);switch(this.type){case"chapter":var e=this.$element.find("#chapter-"+this.position),n=e.nextUntil(".js-task-manage-chapter").last();(0==n.length?e:n).after(s);break;case"task":this.$element.find("#chapter-"+this.position+" .js-lesson-box").append(s);var a=s.parents(".js-lesson-container");this._triggerAsTaskNumUpdated(a);break;case"lesson":n=this.$element.find("#chapter-"+this.position),a=n.nextUntil(".js-task-manage-unit,.js-task-manage-chapter").last();(0==a.length?n:a).after(s);break;default:this.$element.append(s)}$('[data-toggle="tooltip"]').tooltip(),this.handleEmptyShow(),this._flushTaskNumber(),this._flushPublishLessonNum(),this.clearPosition(),this.afterAddItem(s)}},{key:"clearPosition",value:function(){this.position="",this.type=""}},{key:"_deleteChapter",value:function(){var a=this;this.$element.on("click",".js-delete",function(t){var s=$(this),e=s.closest(".task-manage-item"),n=a._getDeleteText(s);cd.confirm({title:Translator.trans("site.delete"),content:n,okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.cancel")}).on("ok",function(){"task"==s.data("type")&&0==e.siblings().length&&e.closest(".js-task-manage-lesson").remove();var t=e.parents(".js-lesson-container");e.remove(),a._triggerAsTaskNumUpdated(t),a.handleEmptyShow(),a._flushTaskNumber(),a._flushPublishLessonNum(),$.post(s.data("url"),function(t){Object(o.a)("success",Translator.trans("site.delete_success_hint")),a.sortList()})})})}},{key:"_getDeleteText",value:function(t){return"task"==t.data("type")?Translator.trans("course.manage.task_delete_hint",{taskName:t.data("name")}):Translator.trans("course.manage.chapter_delete_hint",{name:t.data("name")})}},{key:"_sort",value:function(){var o,e=this;Object(i.a)({element:e.$element,ajax:!1,group:"nested",placeholder:'<li class="placeholder task-dragged-placeholder"></li>',isValidTarget:function(t,s){return e._sortRules(t,s)},onDragStart:function(t,s,e){var n=t.offset(),a=s.rootGroup.pointer;o={left:a.left-n.left,top:a.top-n.top},e(t,s)},onDrag:function(t,s){var e=t.height();$(".task-dragged-placeholder").css({height:e,"background-color":"#eee"}),t.css({left:s.left-o.left,top:s.top-o.top})}},function(t){e.sortList()})}},{key:"_sortRules",value:function(t,s){return(!t.hasClass("js-task-manage-item")||s.target.closest(".js-task-manage-lesson").attr("id")==t.closest(".js-task-manage-lesson").attr("id"))&&(!((t.hasClass("js-task-manage-unit")||t.hasClass("js-task-manage-chapter"))&&!s.target.hasClass("sortable-list"))&&(!t.hasClass("js-task-manage-lesson")||!s.target.hasClass("js-lesson-box")))}},{key:"handleEmptyShow",value:function(){0===$("#sortable-list").find("li").length?$(".js-task-empty").removeClass("hidden"):$(".js-task-empty").addClass("hidden")}},{key:"sortList",value:function(){var t=[];this.$element.find(".task-manage-item").each(function(){t.push($(this).attr("id"))}),$.post(this.$element.data("sortUrl"),{ids:t},function(t){}),this.sortablelist()}},{key:"setShowNum",value:function(t){0==t.attr("show-num")?t.attr("show-num",1):t.attr("show-num",0)}},{key:"sortablelist",value:function(){for(var t=[".js-task-manage-lesson[show-num=1]",".js-task-manage-chapter",".js-task-manage-item[show-num=1]",".js-task-manage-unit"],s=0;s<t.length;s++)this._sortNumberByClassName(t[s]);this._sortUnitNumber()}},{key:"_sortNumberByClassName",value:function(t){var s=1;this.$element.find(t).each(function(){$(this).find(".number").text(s++)})}},{key:"_sortUnitNumber",value:function(){var s;this.$element.find(".js-task-manage-chapter").each(function(){var t=$(this).nextUntil(".js-task-manage-chapter").filter(".js-task-manage-unit");s=1,t.each(function(){$(this).find(".number").text(s++)})})}},{key:"_publish",value:function(){var s=this,e=this,n={class:".js-publish-item, .js-delete, .js-lesson-unpublish-status",oppositeClas:".js-unpublish-item",isHideUnPublish:$("#isHideUnPublish").hasClass("checked"),flag:!1};this.$element.on("click",".js-unpublish-item",function(t){t=$(t.target);n.success=Translator.trans("course.manage.task_unpublish_success_hint"),n.danger=Translator.trans("course.manage.task_unpublish_fail_hint")+":",s.toggleOptional(t,e,n)}),this.$element.on("click",".js-publish-item",function(t){t=$(t.target);n.success=Translator.trans("course.manage.task_publish_success_hint"),n.danger=Translator.trans("course.manage.task_publish_fail_hint")+":",s.toggleOptional(t,e,n)})}},{key:"_flushTaskNumber",value:function(){this.$taskNumber||(this.$taskNumber=$("#task-num"));var t=$(".js-settings-item.active").length;this.$taskNumber.text(t)}},{key:"_flushPublishLessonNum",value:function(){var t=$(".js-settings-item.active").length,s=$(".js-lesson-unpublish-status.hidden").length,s=Translator.trans("course.plan_task.lessons_publish_status",{publishedNum:s,unpublishedNum:t-s});$(".js-lessons-publish-status").attr("data-content",s)}},{key:"_createTask",value:function(){this.$element.on("click",".js-create-task-btn",function(t){var s=$(this).data("url");$.get(s,function(t){t.code?($("#modal").html(""),$("#modal").append(t.html),$("#modal").modal({backdrop:"static",show:!0})):cd.message({type:"danger",message:Translator.trans(t.message)})}).fail(function(t){cd.message({type:"danger",message:t.responseJSON.error.message})})})}},{key:"_optional",value:function(){var s=this,e={class:".js-set-optional",oppositeClas:".js-unset-optional,.js-lesson-option-tag",success:Translator.trans("site.save_success_hint"),danger:Translator.trans("site.save_error_hint")+":",flag:!0};this.$element.on("click",".js-set-optional",function(t){t=$(t.target);s.toggleOptional(t,s,e)}),this.$element.on("click",".js-unset-optional",function(t){t=$(t.target);s.toggleOptional(t,s,e)})}},{key:"_initLessonTaskAction",value:function(){var t,s={"js-lesson-preview-btn":"js-hidden-lesson-preview-btn","js-lesson-edit-btn":"js-hidden-lesson-edit-btn","js-lesson-rename-btn":"js-hidden-lesson-rename-btn"};for(t in s)!function(t){var e=s[t];$("#sortable-list").on("click","."+t,function(){var t=$(this).parents(".js-lesson-container"),s=t.find(".js-task-manage-item").attr("id").split("-")[1],t=t.find("."+e),s=t.data("url").replace("%7BtaskId%7D",s);t.data("url",s),t.data("toggle")?t.click():window.open(t.data("url"),"_blank")})}(t)}},{key:"toggleOptional",value:function(e,n,a){var o=this,i=e.closest(".task-manage-item"),r=i.find(a.class),l=i.find(a.oppositeClas),c=$("#isHideUnPublish").hasClass("checked");$.post(e.data("url"),function(t){var s=!0;c&&(s=n.checkShouldSetProperty(e,i)),r.toggleClass("hidden"),l.toggleClass("hidden"),(c&&s||!c&&a.flag)&&(i.find(".display-text").toggleClass("hidden"),n.setShowNum(i),n.sortList()),o._flushPublishLessonNum(),cd.message({type:"success",message:a.success})}).fail(function(t){cd.message({type:"danger",message:a.danger+t.responseJSON.error.message})})}},{key:"checkShouldSetProperty",value:function(t,s){var e=s.find(".js-publish-item"),n=s.find(".js-set-optional"),s=e.hasClass("hidden"),e=n.hasClass("hidden"),n=!0;return t.hasClass("js-unpublish-item")||t.hasClass("js-publish-item")?e&&(n=!1):(t.hasClass("js-set-optional")||t.hasClass("js-unset-optional"))&&(s||(n=!1)),n}},{key:"afterAddItem",value:function(){console.log("afterAddItem")}},{key:"_triggerAsTaskNumUpdated",value:function(t){var s=t.find(".js-lesson-box"),e=1<s.find(".js-task-manage-item").length;e?(s.removeClass("hidden"),t.find(".js-display-when-mul-tasks").removeClass("hidden"),t.find(".js-display-when-single-task").addClass("hidden")):(s.addClass("hidden"),t.find(".js-display-when-mul-tasks").addClass("hidden"),t.find(".js-display-when-single-task").removeClass("hidden"),t.find(".js-task-title").html(t.find(".js-lesson-title").html())),this._triggerLessonIconAsTaskNumUpdated(t,e)}},{key:"_triggerLessonIconAsTaskNumUpdated",value:function(t,s){var e=t.find(".js-lesson-icon"),n="";n=s?e[0].classList:0==t.find(".js-lesson-box").find(".es-icon").length?[]:t.find(".js-lesson-box").find(".es-icon")[0].classList;for(var a=0;a<n.length;a++){var o=n[a];o.startsWith("es-icon-")&&(s?e.removeClass(o):e.addClass(o))}}}]),s}()},784:function(t,s,e){"use strict";e.r(s);var n=e(2),a=e.n(n),s=e(0),o=e.n(s),n=e(1),i=e.n(n),s=e(8),r=e.n(s),n=e(9),l=e.n(n),s=e(5),c=e.n(s),n=e(279),u=(e(138),function(){function t(){o()(this,t),this._defaultEvent()}return i()(t,[{key:"_defaultEvent",value:function(){void 0===store.get("NormalLessonIntro")&&(this.showAdImage(),store.set("NormalLessonIntro","1")),this.closeModal()}},{key:"closeModal",value:function(){$("#js-intro").on("click",function(t){$("#js-intro").modal("hide")})}},{key:"showAdImage",value:function(){var t=$("#js-intro"),s=new Image,e=$(".js-data-local").data("local");s.src="en"===e?"/assets/img/lessonintro/lessonintro-en.jpg":"/assets/img/lessonintro/lessonintro.jpg";s=$(s);t.find(".modal-body").append(s),t.modal("show")}}]),t}()),s=e(315),e=e(153);function d(e){var n=function(){if("undefined"==typeof Reflect||!a.a)return!1;if(a.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(a()(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,s=c()(e);return s=n?(t=c()(this).constructor,a()(s,arguments,t)):s.apply(this,arguments),l()(this,s)}}new(function(t){r()(e,t);var s=d(e);function e(t){return o()(this,e),t=s.call(this,t),new u,t}return i()(e,[{key:"_flushTaskNumber",value:function(){this.$taskNumber||(this.$taskNumber=$("#task-num"));var t=$(".js-task-manage-item:not(.drag)").length;this.$taskNumber.text(t)}},{key:"_flushPublishLessonNum",value:function(){var t=$(".js-task-manage-item:not(.drag)").length,s=$(".js-lesson-unpublish-status.hidden").length,s=Translator.trans("course.plan_task.lessons_publish_status",{publishedNum:s,unpublishedNum:t-s});$(".js-lessons-publish-status").attr("data-content",s)}},{key:"_triggerAsTaskNumUpdated",value:function(t){var s=t.find(".js-lesson-box"),e=1<s.find(".js-task-manage-item").length;e?s.removeClass("hidden"):s.addClass("hidden"),this._triggerLessonIconAsTaskNumUpdated(t,e)}},{key:"_triggerLessonIconAsTaskNumUpdated",value:function(){}},{key:"sortablelist",value:function(){for(var t=[".js-task-manage-lesson[show-num=1]",".js-task-manage-chapter"],s=0;s<t.length;s++)this._sortNumberByClassName(t[s]);this._sortUnitNumber(),this._sortTaskNumber()}},{key:"_sortTaskNumber",value:function(){var s;this.$element.find(".js-lesson-box").each(function(){var t=$(this).find(".js-task-manage-item");s=0,t.each(function(){$(this).find(".number").text(s++)})})}}]),e}(s.a))("#sortable-list"),Object(n.b)(),Object(n.a)(),Object(e.a)()}});